#
##ORIGINAL STRING TO COW CODE.DO credits are given at the end
##Modified by Casey Crisman-Cox for R, 16 June 2012
##NOTES: If  country==
##                                      Yemen and both YAR and YPR exist then it defaults to YAR
##                                              Germany and both GFR and GDR exist defaults to GFR
##                                              Vietnam and both DRV and RVN exist then defaults to RVN
##                                              Only use this file for post 1945
stringr.to.cow<-function(country, year, data){
  require(stringr)
  ccode<- vector(length=length(country))
  if(class(country)=="factor"){
    cctry<-as.character(country)
    ccode<-cbind.data.frame(cctry, ccode, stringsAsFactors=FALSE)}else{
      ccode<-cbind.data.frame(country, ccode, stringsAsFactors=FALSE)
      colnames(ccode)[1]<-"cctry"
    }
  2 -> ccode$ccode[str_detect(ccode$cctry, fixed("United States of America", ignore_case=TRUE))]
  2 -> ccode$ccode[str_detect(ccode$cctry, fixed("United States", ignore_case=TRUE))]
  2 -> ccode$ccode[str_detect(ccode$cctry, fixed("USA", ignore_case=TRUE))]
  20 -> ccode$ccode[str_detect(ccode$cctry, fixed("Canada", ignore_case=TRUE))]
  31 -> ccode$ccode[str_detect(ccode$cctry, fixed("Bahamas", ignore_case=TRUE))]
  31 -> ccode$ccode[str_detect(ccode$cctry, fixed("Bahamas, The", ignore_case=TRUE))]
  40 -> ccode$ccode[str_detect(ccode$cctry, fixed("Cuba", ignore_case=TRUE))]
  41 -> ccode$ccode[str_detect(ccode$cctry, fixed("Haiti", ignore_case=TRUE))]
  54 -> ccode$ccode[str_detect(ccode$cctry, fixed("Dominica", ignore_case=TRUE))]
  42 -> ccode$ccode[str_detect(ccode$cctry, fixed("Dominican Republic", ignore_case=TRUE))]
  42 -> ccode$ccode[str_detect(ccode$cctry, fixed("DominRep", ignore_case=TRUE))]
  51 -> ccode$ccode[str_detect(ccode$cctry, fixed("Jamaica", ignore_case=TRUE))]
  52 -> ccode$ccode[str_detect(ccode$cctry, fixed("Trinidad and Tobago", ignore_case=TRUE))]
  52 -> ccode$ccode[str_detect(ccode$cctry, fixed("Trinidad", ignore_case=TRUE))]
  52 -> ccode$ccode[str_detect(ccode$cctry, fixed("Trinidad & Tobago", ignore_case=TRUE))]
  52 -> ccode$ccode[str_detect(ccode$cctry, fixed("Trinidad &Tobago", ignore_case=TRUE))]
  53 -> ccode$ccode[str_detect(ccode$cctry, fixed("Barbados", ignore_case=TRUE))]
  55 -> ccode$ccode[str_detect(ccode$cctry, fixed("Grenada", ignore_case=TRUE))]
  56 -> ccode$ccode[str_detect(ccode$cctry, fixed("St. Lucia", ignore_case=TRUE))]
  56 -> ccode$ccode[str_detect(ccode$cctry, fixed("Saint Lucia", ignore_case=TRUE))]
  57 -> ccode$ccode[str_detect(ccode$cctry, fixed("St. Vincent and the Grenadines", ignore_case=TRUE))]
  57 -> ccode$ccode[str_detect(ccode$cctry, fixed("Saint Vincent and the Grenadines", ignore_case=TRUE))]
  57 -> ccode$ccode[str_detect(ccode$cctry, fixed("St. Vincent and Grenadines", ignore_case=TRUE))]
  57 -> ccode$ccode[str_detect(ccode$cctry, fixed("St. Vincent & Grens.", ignore_case=TRUE))]
  57 -> ccode$ccode[str_detect(ccode$cctry, fixed("St. Vincent & Grenadines", ignore_case=TRUE))]
  57 -> ccode$ccode[str_detect(ccode$cctry, fixed("St.Vincent & Grenadines", ignore_case=TRUE))]
  58 -> ccode$ccode[str_detect(ccode$cctry, fixed("Antigua & Barbuda", ignore_case=TRUE))]
  58 -> ccode$ccode[str_detect(ccode$cctry, fixed("Antigua and Barbuda", ignore_case=TRUE))]
  58 -> ccode$ccode[str_detect(ccode$cctry, fixed("Antigua", ignore_case=TRUE))]
  60 -> ccode$ccode[str_detect(ccode$cctry, fixed("St. Kitts and Nevis", ignore_case=TRUE))]
  60 -> ccode$ccode[str_detect(ccode$cctry, fixed("Saint Kitts and Nevis", ignore_case=TRUE))]
  60 -> ccode$ccode[str_detect(ccode$cctry, fixed("St. Kitts & Nevis", ignore_case=TRUE))]
  70 -> ccode$ccode[str_detect(ccode$cctry, fixed("Mexico", ignore_case=TRUE))]
  80 -> ccode$ccode[str_detect(ccode$cctry, fixed("Belize", ignore_case=TRUE))]
  90 -> ccode$ccode[str_detect(ccode$cctry, fixed("Guatemala", ignore_case=TRUE))]
  90 -> ccode$ccode[str_detect(ccode$cctry, fixed("Guatemal", ignore_case=TRUE))]
  91 -> ccode$ccode[str_detect(ccode$cctry, fixed("Honduras", ignore_case=TRUE))]
  92 -> ccode$ccode[str_detect(ccode$cctry, fixed("El Salvador", ignore_case=TRUE))]
  92 -> ccode$ccode[str_detect(ccode$cctry, fixed("ElSalvad", ignore_case=TRUE))]
  93 -> ccode$ccode[str_detect(ccode$cctry, fixed("Nicaragua", ignore_case=TRUE))]
  93 -> ccode$ccode[str_detect(ccode$cctry, fixed("Nicaragu", ignore_case=TRUE))]
  94 -> ccode$ccode[str_detect(ccode$cctry, fixed("Costa Rica", ignore_case=TRUE))]
  94 -> ccode$ccode[str_detect(ccode$cctry, fixed("CostaRic", ignore_case=TRUE))]
  94 -> ccode$ccode[str_detect(ccode$cctry, fixed("CostaRica", ignore_case=TRUE))]
  95 -> ccode$ccode[str_detect(ccode$cctry, fixed("Panama", ignore_case=TRUE))]
  100 -> ccode$ccode[str_detect(ccode$cctry, fixed("Colombia", ignore_case=TRUE))]
  101 -> ccode$ccode[str_detect(ccode$cctry, fixed("Venezuela", ignore_case=TRUE))]
  101 -> ccode$ccode[str_detect(ccode$cctry, fixed("Venezuel", ignore_case=TRUE))]
  101 -> ccode$ccode[str_detect(ccode$cctry, fixed("Venezuela, Rep. Bol.", ignore_case=TRUE))]
  110 -> ccode$ccode[str_detect(ccode$cctry, fixed("Guyana", ignore_case=TRUE))]
  115 -> ccode$ccode[str_detect(ccode$cctry, fixed("Suriname", ignore_case=TRUE))]
  130 -> ccode$ccode[str_detect(ccode$cctry, fixed("Ecuador", ignore_case=TRUE))]
  135 -> ccode$ccode[str_detect(ccode$cctry, fixed("Peru", ignore_case=TRUE))]
  140 -> ccode$ccode[str_detect(ccode$cctry, fixed("Brazil", ignore_case=TRUE))]
  145 -> ccode$ccode[str_detect(ccode$cctry, fixed("Bolivia", ignore_case=TRUE))]
  150 -> ccode$ccode[str_detect(ccode$cctry, fixed("Paraguay", ignore_case=TRUE))]
  155 -> ccode$ccode[str_detect(ccode$cctry, fixed("Chile", ignore_case=TRUE))]
  160 -> ccode$ccode[str_detect(ccode$cctry, fixed("Argentina", ignore_case=TRUE))]
  160 -> ccode$ccode[str_detect(ccode$cctry, fixed("Argentin", ignore_case=TRUE))]
  165 -> ccode$ccode[str_detect(ccode$cctry, fixed("Uruguay", ignore_case=TRUE))]
  200 -> ccode$ccode[str_detect(ccode$cctry, fixed("United Kingdom", ignore_case=TRUE))]
  200 -> ccode$ccode[str_detect(ccode$cctry, fixed("UKG", ignore_case=TRUE))]
  200 -> ccode$ccode[str_detect(ccode$cctry, fixed("UK", ignore_case=TRUE))]
  205 -> ccode$ccode[str_detect(ccode$cctry, fixed("Ireland", ignore_case=TRUE))]
  210 -> ccode$ccode[str_detect(ccode$cctry, fixed("Netherlands", ignore_case=TRUE))]
  210 -> ccode$ccode[str_detect(ccode$cctry, fixed("Netherla", ignore_case=TRUE))]
  211 -> ccode$ccode[str_detect(ccode$cctry, fixed("Belgium", ignore_case=TRUE))]
  212 -> ccode$ccode[str_detect(ccode$cctry, fixed("Luxembourg", ignore_case=TRUE))]
  212 -> ccode$ccode[str_detect(ccode$cctry, fixed("Luxembou", ignore_case=TRUE))]
  220 -> ccode$ccode[str_detect(ccode$cctry, fixed("France", ignore_case=TRUE))]
  221 -> ccode$ccode[str_detect(ccode$cctry, fixed("Monaco", ignore_case=TRUE))]
  223 -> ccode$ccode[str_detect(ccode$cctry, fixed("Liechtenstein", ignore_case=TRUE))]
  225 -> ccode$ccode[str_detect(ccode$cctry, fixed("Switzerland", ignore_case=TRUE))]
  225 -> ccode$ccode[str_detect(ccode$cctry, fixed("Switzerl", ignore_case=TRUE))]
  230 -> ccode$ccode[str_detect(ccode$cctry, fixed("Spain", ignore_case=TRUE))]
  232 -> ccode$ccode[str_detect(ccode$cctry, fixed("Andorra", ignore_case=TRUE))]
  235 -> ccode$ccode[str_detect(ccode$cctry, fixed("Portugal", ignore_case=TRUE))]
  255 -> ccode$ccode[str_detect(ccode$cctry, fixed("Germany")) & year>=1991]

  260 -> ccode$ccode[str_detect(ccode$cctry, fixed("German Federal Republic", ignore_case=TRUE))]
  260 -> ccode$ccode[str_detect(ccode$cctry, fixed("Germany, West", ignore_case=TRUE))]
  260 -> ccode$ccode[str_detect(ccode$cctry, fixed("West Germany", ignore_case=TRUE))]
  260 -> ccode$ccode[str_detect(ccode$cctry, fixed("Germany")) & year<=1990]

  265 -> ccode$ccode[str_detect(ccode$cctry, fixed("German Democratic Republic", ignore_case=TRUE))]
  265 -> ccode$ccode[str_detect(ccode$cctry, fixed("GERMAN DEM. REP.", ignore_case=TRUE))]
  265 -> ccode$ccode[str_detect(ccode$cctry, fixed("Germany, East", ignore_case=TRUE))]
  290 -> ccode$ccode[str_detect(ccode$cctry, fixed("Poland", ignore_case=TRUE))]
  305 -> ccode$ccode[str_detect(ccode$cctry, fixed("Austria", ignore_case=TRUE))]
  310 -> ccode$ccode[str_detect(ccode$cctry, fixed("Hungary", ignore_case=TRUE))]
  315 -> ccode$ccode[str_detect(ccode$cctry, fixed("Czechoslovakia", ignore_case=TRUE))]
  316 -> ccode$ccode[str_detect(ccode$cctry, fixed("Czech Republic", ignore_case=TRUE))]
  316 -> ccode$ccode[str_detect(ccode$cctry, fixed("czechrep", ignore_case=TRUE))]
  317 -> ccode$ccode[str_detect(ccode$cctry, fixed("Slovakia", ignore_case=TRUE))]
  317 -> ccode$ccode[str_detect(ccode$cctry, fixed("Slovak Republic", ignore_case=TRUE))]
  325 -> ccode$ccode[str_detect(ccode$cctry, fixed("Italy", ignore_case=TRUE))]
  331 -> ccode$ccode[str_detect(ccode$cctry, fixed("San Marino", ignore_case=TRUE))]
  338 -> ccode$ccode[str_detect(ccode$cctry, fixed("Malta", ignore_case=TRUE))]
  339 -> ccode$ccode[str_detect(ccode$cctry, fixed("Albania", ignore_case=TRUE))]
  341 -> ccode$ccode[str_detect(ccode$cctry, fixed("Montenegro", ignore_case=TRUE))]
  343 -> ccode$ccode[str_detect(ccode$cctry, fixed("Macedonia", ignore_case=TRUE))]
  343 -> ccode$ccode[str_detect(ccode$cctry, fixed("Macedonia, Former Yugoslav Republic", ignore_case=TRUE))]
  344 -> ccode$ccode[str_detect(ccode$cctry, fixed("Croatia", ignore_case=TRUE))]
  345 -> ccode$ccode[str_detect(ccode$cctry, fixed("Yugoslavia", ignore_case=TRUE))]
  345 -> ccode$ccode[str_detect(ccode$cctry, fixed("Serbia", ignore_case=TRUE))]
  345 -> ccode$ccode[str_detect(ccode$cctry, fixed("Serbia and Montenegro", ignore_case=TRUE))]
  345 -> ccode$ccode[str_detect(ccode$cctry, fixed("Serbia and Montenegro, Former", ignore_case=TRUE))]
  346 -> ccode$ccode[str_detect(ccode$cctry, fixed("Bosnia and Herzegovina", ignore_case=TRUE))]
  346 -> ccode$ccode[str_detect(ccode$cctry, fixed("Bosnia", ignore_case=TRUE))]
  346 -> ccode$ccode[str_detect(ccode$cctry, fixed("Bosnia-Herzegovina", ignore_case=TRUE))]
  346 -> ccode$ccode[str_detect(ccode$cctry, fixed("Bosnia & Herzegovina", ignore_case=TRUE))]
  347 -> ccode$ccode[str_detect(ccode$cctry, fixed("Kosovo", ignore_case=TRUE))]
  349 -> ccode$ccode[str_detect(ccode$cctry, fixed("Slovenia", ignore_case=TRUE))]
  350 -> ccode$ccode[str_detect(ccode$cctry, fixed("Greece", ignore_case=TRUE))]
  352 -> ccode$ccode[str_detect(ccode$cctry, fixed("Cyprus", ignore_case=TRUE))]
  352 -> ccode$ccode[str_detect(ccode$cctry, fixed("Cyprus (Greek)", ignore_case=TRUE))]
  355 -> ccode$ccode[str_detect(ccode$cctry, fixed("Bulgaria", ignore_case=TRUE))]
  359 -> ccode$ccode[str_detect(ccode$cctry, fixed("Moldova", ignore_case=TRUE))]
  698 -> ccode$ccode[str_detect(ccode$cctry, fixed("Oman", ignore_case=TRUE))]
  360 -> ccode$ccode[str_detect(ccode$cctry, fixed("Romania", ignore_case=TRUE))]
  365 -> ccode$ccode[str_detect(ccode$cctry, fixed("Russia", ignore_case=TRUE))]
  365 -> ccode$ccode[str_detect(ccode$cctry, fixed("USSR", ignore_case=TRUE))]
  365 -> ccode$ccode[str_detect(ccode$cctry, fixed("Soviet Union", ignore_case=TRUE))]
  366 -> ccode$ccode[str_detect(ccode$cctry, fixed("Estonia", ignore_case=TRUE))]
  367 -> ccode$ccode[str_detect(ccode$cctry, fixed("Latvia", ignore_case=TRUE))]
  368 -> ccode$ccode[str_detect(ccode$cctry, fixed("Lithuania", ignore_case=TRUE))]
  369 -> ccode$ccode[str_detect(ccode$cctry, fixed("Ukraine", ignore_case=TRUE))]
  370 -> ccode$ccode[str_detect(ccode$cctry, fixed("Belarus", ignore_case=TRUE))]
  371 -> ccode$ccode[str_detect(ccode$cctry, fixed("Armenia", ignore_case=TRUE))]
  372 -> ccode$ccode[str_detect(ccode$cctry, fixed("Georgia", ignore_case=TRUE))]
  373 -> ccode$ccode[str_detect(ccode$cctry, fixed("Azerbaijan", ignore_case=TRUE))]
  375 -> ccode$ccode[str_detect(ccode$cctry, fixed("Finland", ignore_case=TRUE))]
  380 -> ccode$ccode[str_detect(ccode$cctry, fixed("Sweden", ignore_case=TRUE))]
  385 -> ccode$ccode[str_detect(ccode$cctry, fixed("Norway", ignore_case=TRUE))]
  390 -> ccode$ccode[str_detect(ccode$cctry, fixed("Denmark", ignore_case=TRUE))]
  390 -> ccode$ccode[str_detect(ccode$cctry, fixed("Denmark", ignore_case=TRUE))]
  395 -> ccode$ccode[str_detect(ccode$cctry, fixed("Iceland", ignore_case=TRUE))]
  402 -> ccode$ccode[str_detect(ccode$cctry, fixed("Cape Verde", ignore_case=TRUE))]
  403 -> ccode$ccode[str_detect(ccode$cctry, fixed("Sao Tome and Principe", ignore_case=TRUE))]
  403 -> ccode$ccode[str_detect(ccode$cctry, fixed("Sao Tome & Principe", ignore_case=TRUE))]
  438 -> ccode$ccode[str_detect(ccode$cctry, fixed("Guinea", ignore_case=TRUE))]
  404 -> ccode$ccode[str_detect(ccode$cctry, fixed("Guinea-Bissau", ignore_case=TRUE))]
  404 -> ccode$ccode[str_detect(ccode$cctry, fixed("Guinea Bissau", ignore_case=TRUE))]
  411 -> ccode$ccode[str_detect(ccode$cctry, fixed("Equatorial Guinea", ignore_case=TRUE))]
  420 -> ccode$ccode[str_detect(ccode$cctry, fixed("Gambia", ignore_case=TRUE))]
  420 -> ccode$ccode[str_detect(ccode$cctry, fixed("Gambia, The", ignore_case=TRUE))]
  432 -> ccode$ccode[str_detect(ccode$cctry, fixed("Mali", ignore_case=TRUE))]
  433 -> ccode$ccode[str_detect(ccode$cctry, fixed("Senegal", ignore_case=TRUE))]
  434 -> ccode$ccode[str_detect(ccode$cctry, fixed("Benin", ignore_case=TRUE))]
  435 -> ccode$ccode[str_detect(ccode$cctry, fixed("Mauritania", ignore_case=TRUE))]
  435 -> ccode$ccode[str_detect(ccode$cctry, fixed("Mauritan", ignore_case=TRUE))]
  436 -> ccode$ccode[str_detect(ccode$cctry, fixed("Niger", ignore_case=TRUE))]
  437 -> ccode$ccode[str_detect(ccode$cctry, fixed("Ivory Coast", ignore_case=TRUE))]
  437 -> ccode$ccode[str_detect(ccode$cctry, fixed("IvoryCoa", ignore_case=TRUE))]
  437 -> ccode$ccode[str_detect(ccode$cctry, fixed("C?te d'Ivoire", ignore_case=TRUE))]
  437 -> ccode$ccode[str_detect(ccode$cctry, fixed("C?te d'Ivoire", ignore_case=TRUE))]
  437 -> ccode$ccode[str_detect(ccode$cctry, fixed("Cote d'Ivoire", ignore_case=TRUE))]
  437 -> ccode$ccode[str_detect(ccode$cctry, fixed("Côte d'Ivoire", ignore_case=TRUE))]
  437 -> ccode$ccode[str_detect(ccode$cctry, fixed("Cote dIvoire", ignore_case=TRUE))]
  439 -> ccode$ccode[str_detect(ccode$cctry, fixed("Burkina Faso", ignore_case=TRUE))]
  439 -> ccode$ccode[str_detect(ccode$cctry, fixed("BurkinaF", ignore_case=TRUE))]
  450 -> ccode$ccode[str_detect(ccode$cctry, fixed("Liberia", ignore_case=TRUE))]
  451 -> ccode$ccode[str_detect(ccode$cctry, fixed("Sierra Leone", ignore_case=TRUE))]
  451 -> ccode$ccode[str_detect(ccode$cctry, fixed("SierraLe", ignore_case=TRUE))]
  452 -> ccode$ccode[str_detect(ccode$cctry, fixed("Ghana", ignore_case=TRUE))]
  461 -> ccode$ccode[str_detect(ccode$cctry, fixed("Togo", ignore_case=TRUE))]
  471 -> ccode$ccode[str_detect(ccode$cctry, fixed("Cameroon", ignore_case=TRUE))]
  475 -> ccode$ccode[str_detect(ccode$cctry, fixed("Nigeria", ignore_case=TRUE))]
  481 -> ccode$ccode[str_detect(ccode$cctry, fixed("Gabon", ignore_case=TRUE))]
  482 -> ccode$ccode[str_detect(ccode$cctry, fixed("Central African Republic", ignore_case=TRUE))]
  482 -> ccode$ccode[str_detect(ccode$cctry, fixed("Central African Rep.", ignore_case=TRUE))]
  482 -> ccode$ccode[str_detect(ccode$cctry, fixed("Central African Rep", ignore_case=TRUE))]
  482 -> ccode$ccode[str_detect(ccode$cctry, fixed("CentralA", ignore_case=TRUE))]
  483 -> ccode$ccode[str_detect(ccode$cctry, fixed("Chad", ignore_case=TRUE))]
  484 -> ccode$ccode[str_detect(ccode$cctry, fixed("Congo", ignore_case=TRUE))]
  484 -> ccode$ccode[str_detect(ccode$cctry, fixed("Congo, Republic of the", ignore_case=TRUE))]
  484 -> ccode$ccode[str_detect(ccode$cctry, fixed("Congo, Republic of", ignore_case=TRUE))]
  484 -> ccode$ccode[str_detect(ccode$cctry, fixed("Congo, Rep.", ignore_case=TRUE))]
  484 -> ccode$ccode[str_detect(ccode$cctry, fixed("Congo, Rep", ignore_case=TRUE))]
  484 -> ccode$ccode[str_detect(ccode$cctry, fixed("Congo-Brazzaville", ignore_case=TRUE))]
  484 -> ccode$ccode[str_detect(ccode$cctry, fixed("Congo (Brazzaville)", ignore_case=TRUE))]
  484 -> ccode$ccode[str_detect(ccode$cctry, fixed("Congo, Republic of (Brazzaville)", ignore_case=TRUE))]
  484 -> ccode$ccode[str_detect(ccode$cctry, fixed("Congo, Brazzaville", ignore_case=TRUE))]
  490 -> ccode$ccode[str_detect(ccode$cctry, fixed("Democratic Republic of the Congo", ignore_case=TRUE))]
  490 -> ccode$ccode[str_detect(ccode$cctry, fixed("Congo, Democratic Republic of the", ignore_case=TRUE))]
  490 -> ccode$ccode[str_detect(ccode$cctry, fixed("Congo, Democratic Republic", ignore_case=TRUE))]
  490 -> ccode$ccode[str_detect(ccode$cctry, fixed("Congo, Dem. Rep. of", ignore_case=TRUE))]
  490 -> ccode$ccode[str_detect(ccode$cctry, fixed("Congo, Dem. Rep.", ignore_case=TRUE))]
  490 -> ccode$ccode[str_detect(ccode$cctry, fixed("Congo-Kinshasa", ignore_case=TRUE))]
  490 -> ccode$ccode[str_detect(ccode$cctry, fixed("Congo (Kinshasa)", ignore_case=TRUE))]
  490 -> ccode$ccode[str_detect(ccode$cctry, fixed("Congo, Democratic Republic of (Kinshasa)", ignore_case=TRUE))]
  490 -> ccode$ccode[str_detect(ccode$cctry, fixed("Congo, DR", ignore_case=TRUE))]
  490 -> ccode$ccode[str_detect(ccode$cctry, fixed("DEM. REP. CONGO", ignore_case=TRUE))]
  490 -> ccode$ccode[str_detect(ccode$cctry, fixed("Congo-Zaire", ignore_case=TRUE))]
  490 -> ccode$ccode[str_detect(ccode$cctry, fixed("Zaire", ignore_case=TRUE))]
  500 -> ccode$ccode[str_detect(ccode$cctry, fixed("Uganda", ignore_case=TRUE))]
  501 -> ccode$ccode[str_detect(ccode$cctry, fixed("Kenya", ignore_case=TRUE))]
  510 -> ccode$ccode[str_detect(ccode$cctry, fixed("Tanzania", ignore_case=TRUE))]
  511 -> ccode$ccode[str_detect(ccode$cctry, fixed("Zanzibar", ignore_case=TRUE))]
  516 -> ccode$ccode[str_detect(ccode$cctry, fixed("Burundi", ignore_case=TRUE))]
  517 -> ccode$ccode[str_detect(ccode$cctry, fixed("Rwanda", ignore_case=TRUE))]
  520 -> ccode$ccode[str_detect(ccode$cctry, fixed("Somalia", ignore_case=TRUE))]
  522 -> ccode$ccode[str_detect(ccode$cctry, fixed("Djibouti", ignore_case=TRUE))]
  530 -> ccode$ccode[str_detect(ccode$cctry, fixed("Ethiopia", ignore_case=TRUE))]
  531 -> ccode$ccode[str_detect(ccode$cctry, fixed("Eritrea", ignore_case=TRUE))]
  540 -> ccode$ccode[str_detect(ccode$cctry, fixed("Angola", ignore_case=TRUE))]
  541 -> ccode$ccode[str_detect(ccode$cctry, fixed("Mozambique", ignore_case=TRUE))]
  551 -> ccode$ccode[str_detect(ccode$cctry, fixed("Zambia", ignore_case=TRUE))]
  552 -> ccode$ccode[str_detect(ccode$cctry, fixed("Zimbabwe", ignore_case=TRUE))]
  553 -> ccode$ccode[str_detect(ccode$cctry, fixed("Malawi", ignore_case=TRUE))]
  560 -> ccode$ccode[str_detect(ccode$cctry, fixed("South Africa", ignore_case=TRUE))]
  560 -> ccode$ccode[str_detect(ccode$cctry, fixed("SouthAfr", ignore_case=TRUE))]
  565 -> ccode$ccode[str_detect(ccode$cctry, fixed("Namibia", ignore_case=TRUE))]
  570 -> ccode$ccode[str_detect(ccode$cctry, fixed("Lesotho", ignore_case=TRUE))]
  571 -> ccode$ccode[str_detect(ccode$cctry, fixed("Botswana", ignore_case=TRUE))]
  572 -> ccode$ccode[str_detect(ccode$cctry, fixed("Swaziland", ignore_case=TRUE))]
  572 -> ccode$ccode[str_detect(ccode$cctry, fixed("Swazilan", ignore_case=TRUE))]
  580 -> ccode$ccode[str_detect(ccode$cctry, fixed("Madagascar", ignore_case=TRUE))]
  580 -> ccode$ccode[str_detect(ccode$cctry, fixed("Madagasc", ignore_case=TRUE))]
  581 -> ccode$ccode[str_detect(ccode$cctry, fixed("Comoros", ignore_case=TRUE))]
  590 -> ccode$ccode[str_detect(ccode$cctry, fixed("Mauritius", ignore_case=TRUE))]
  590 -> ccode$ccode[str_detect(ccode$cctry, fixed("Mauritiu", ignore_case=TRUE))]
  591 -> ccode$ccode[str_detect(ccode$cctry, fixed("Seychelles", ignore_case=TRUE))]
  600 -> ccode$ccode[str_detect(ccode$cctry, fixed("Morocco", ignore_case=TRUE))]
  600 -> ccode$ccode[str_detect(ccode$cctry, fixed("Morocco/Western Sahara", ignore_case=TRUE))]
  615 -> ccode$ccode[str_detect(ccode$cctry, fixed("Algeria", ignore_case=TRUE))]
  616 -> ccode$ccode[str_detect(ccode$cctry, fixed("Tunisia", ignore_case=TRUE))]
  620 -> ccode$ccode[str_detect(ccode$cctry, fixed("Libya", ignore_case=TRUE))]
  625 -> ccode$ccode[str_detect(ccode$cctry, fixed("Sudan", ignore_case=TRUE))]
  630 -> ccode$ccode[str_detect(ccode$cctry, fixed("Iran", ignore_case=TRUE))]
  630 -> ccode$ccode[str_detect(ccode$cctry, fixed("Iran, Islamic Republic", ignore_case=TRUE))]
  630 -> ccode$ccode[str_detect(ccode$cctry, fixed("Iran, Ismalic Rep.", ignore_case=TRUE))]
  630 -> ccode$ccode[str_detect(ccode$cctry, fixed("Iran, Ismalic Rep", ignore_case=TRUE))]
  640 -> ccode$ccode[str_detect(ccode$cctry, fixed("Turkey", ignore_case=TRUE))]
  645 -> ccode$ccode[str_detect(ccode$cctry, fixed("Iraq", ignore_case=TRUE))]
  651 -> ccode$ccode[str_detect(ccode$cctry, fixed("Egypt", ignore_case=TRUE))]
  651 -> ccode$ccode[str_detect(ccode$cctry, fixed("Egypt, Arab Republic", ignore_case=TRUE))]
  651 -> ccode$ccode[str_detect(ccode$cctry, fixed("Egypt, Arab Rep.", ignore_case=TRUE))]
  652 -> ccode$ccode[str_detect(ccode$cctry, fixed("Syria", ignore_case=TRUE))]
  652 -> ccode$ccode[str_detect(ccode$cctry, fixed("Syrian Arab Republic", ignore_case=TRUE))]
  660 -> ccode$ccode[str_detect(ccode$cctry, fixed("Lebanon", ignore_case=TRUE))]
  663 -> ccode$ccode[str_detect(ccode$cctry, fixed("Jordan", ignore_case=TRUE))]
  666 -> ccode$ccode[str_detect(ccode$cctry, fixed("Israel", ignore_case=TRUE))]
  670 -> ccode$ccode[str_detect(ccode$cctry, fixed("Saudi Arabia", ignore_case=TRUE))]
  670 -> ccode$ccode[str_detect(ccode$cctry, fixed("SaudiAra", ignore_case=TRUE))]
  678 -> ccode$ccode[str_detect(ccode$cctry, fixed("Yemen")) & year<=1990]
  678 -> ccode$ccode[str_detect(ccode$cctry, fixed("Yemen AR", ignore_case=TRUE))]
  679 -> ccode$ccode[str_detect(ccode$cctry, fixed("Yemen")) & year>=1990]
  678 -> ccode$ccode[str_detect(ccode$cctry, fixed("Yemen Arab Republic", ignore_case=TRUE))]
  678 -> ccode$ccode[str_detect(ccode$cctry, fixed("YEMEN ARAB REP.", ignore_case=TRUE))]
  678 -> ccode$ccode[str_detect(ccode$cctry, fixed("North Yemen", ignore_case=TRUE))]
  678 -> ccode$ccode[str_detect(ccode$cctry, fixed("Yemen, North", ignore_case=TRUE))]

  679 -> ccode$ccode[str_detect(ccode$cctry, fixed("Yemen, Rep.")) & year<=1990]
  679 -> ccode$ccode[str_detect(ccode$cctry, fixed("Yemen, Republic of"))& year<=1990]


  679 -> ccode$ccode[str_detect(ccode$cctry, fixed("Yemen, Rep."))& year>=1990]
  679 -> ccode$ccode[str_detect(ccode$cctry, fixed("Yemen, Republic of"))& year>=1990]

  680 -> ccode$ccode[str_detect(ccode$cctry, fixed("Yemen People's Republic", ignore_case=TRUE))]
  680 -> ccode$ccode[str_detect(ccode$cctry, fixed("Yemen PR", ignore_case=TRUE))]
  680 -> ccode$ccode[str_detect(ccode$cctry, fixed("South Yemen", ignore_case=TRUE))]
  680 -> ccode$ccode[str_detect(ccode$cctry, fixed("Yemen, South", ignore_case=TRUE))]
  680 -> ccode$ccode[str_detect(ccode$cctry, fixed("YEMEN PEOP. REP.", ignore_case=TRUE))]
  690 -> ccode$ccode[str_detect(ccode$cctry, fixed("Kuwait", ignore_case=TRUE))]
  692 -> ccode$ccode[str_detect(ccode$cctry, fixed("Bahrain", ignore_case=TRUE))]
  694 -> ccode$ccode[str_detect(ccode$cctry, fixed("Qatar", ignore_case=TRUE))]
  696 -> ccode$ccode[str_detect(ccode$cctry, fixed("United Arab Emirates", ignore_case=TRUE))]
  696 -> ccode$ccode[str_detect(ccode$cctry, fixed("U. ARAB EMIRATES", ignore_case=TRUE))]

  700 -> ccode$ccode[str_detect(ccode$cctry, fixed("Afghanistan", ignore_case=TRUE))]
  701 -> ccode$ccode[str_detect(ccode$cctry, fixed("Turkmenistan", ignore_case=TRUE))]
  702 -> ccode$ccode[str_detect(ccode$cctry, fixed("Tajikistan", ignore_case=TRUE))]
  703 -> ccode$ccode[str_detect(ccode$cctry, fixed("Kyrgyzstan", ignore_case=TRUE))]
  703 -> ccode$ccode[str_detect(ccode$cctry, fixed("Kyrgyz Republic", ignore_case=TRUE))]
  704 -> ccode$ccode[str_detect(ccode$cctry, fixed("Uzbekistan", ignore_case=TRUE))]
  705 -> ccode$ccode[str_detect(ccode$cctry, fixed("Kazakhstan", ignore_case=TRUE))]
  710 -> ccode$ccode[str_detect(ccode$cctry, fixed("China", ignore_case=TRUE))]
  710 -> ccode$ccode[str_detect(ccode$cctry, fixed("China, People's Republic", ignore_case=TRUE))]
  710 -> ccode$ccode[str_detect(ccode$cctry, fixed("China, People's Rep.", ignore_case=TRUE))]
  710 -> ccode$ccode[str_detect(ccode$cctry, fixed("China, People's Rep", ignore_case=TRUE))]
  710 -> ccode$ccode[str_detect(ccode$cctry, fixed("China, PRC", ignore_case=TRUE))]
  710 -> ccode$ccode[str_detect(ccode$cctry, fixed("China (P.R.C.)", ignore_case=TRUE))]
  710 -> ccode$ccode[str_detect(ccode$cctry, fixed("China,P.R.: Mainland", ignore_case=TRUE))]
  712 -> ccode$ccode[str_detect(ccode$cctry, fixed("Mongolia", ignore_case=TRUE))]
  713 -> ccode$ccode[str_detect(ccode$cctry, fixed("Taiwan", ignore_case=TRUE))]
  713 -> ccode$ccode[str_detect(ccode$cctry, fixed("Taiwan, China", ignore_case=TRUE))]
  713 -> ccode$ccode[str_detect(ccode$cctry, fixed("China (Taiwan)", ignore_case=TRUE))]
  730 -> ccode$ccode[str_detect(ccode$cctry, fixed("Korea", ignore_case=TRUE))]
  731 -> ccode$ccode[str_detect(ccode$cctry, fixed("North Korea", ignore_case=TRUE))]
  731 -> ccode$ccode[str_detect(ccode$cctry, fixed("Korea, North", ignore_case=TRUE))]
  731 -> ccode$ccode[str_detect(ccode$cctry, fixed("KOREA, N.", ignore_case=TRUE))]
  731 -> ccode$ccode[str_detect(ccode$cctry, fixed("Korea, Democratic Republic", ignore_case=TRUE))]
  731 -> ccode$ccode[str_detect(ccode$cctry, fixed("Korea, Dem. Rep.", ignore_case=TRUE))]
  732 -> ccode$ccode[str_detect(ccode$cctry, fixed("South Korea", ignore_case=TRUE))]
  732 -> ccode$ccode[str_detect(ccode$cctry, fixed("KOREA, S.", ignore_case=TRUE))]
  732 -> ccode$ccode[str_detect(ccode$cctry, fixed("Korea, South", ignore_case=TRUE))]
  732 -> ccode$ccode[str_detect(ccode$cctry, fixed("Korea, Republic of", ignore_case=TRUE))]
  732 -> ccode$ccode[str_detect(ccode$cctry, fixed("Republic of Korea", ignore_case=TRUE))]
  732 -> ccode$ccode[str_detect(ccode$cctry, fixed("Korea, Rep.", ignore_case=TRUE))]
  740 -> ccode$ccode[str_detect(ccode$cctry, fixed("Japan", ignore_case=TRUE))]
  750 -> ccode$ccode[str_detect(ccode$cctry, fixed("India", ignore_case=TRUE))]
  760 -> ccode$ccode[str_detect(ccode$cctry, fixed("Bhutan", ignore_case=TRUE))]
  770 -> ccode$ccode[str_detect(ccode$cctry, fixed("Pakistan", ignore_case=TRUE))]
  771 -> ccode$ccode[str_detect(ccode$cctry, fixed("Bangladesh", ignore_case=TRUE))]
  775 -> ccode$ccode[str_detect(ccode$cctry, fixed("Myanmar", ignore_case=TRUE))]
  775 -> ccode$ccode[str_detect(ccode$cctry, fixed("Burma", ignore_case=TRUE))]
  775 -> ccode$ccode[str_detect(ccode$cctry, fixed("Burma (Myanmar)", ignore_case=TRUE))]
  775 -> ccode$ccode[str_detect(ccode$cctry, fixed("Myanmar/Burma", ignore_case=TRUE))]
  775 -> ccode$ccode[str_detect(ccode$cctry, fixed("Myanmar (Burma)", ignore_case=TRUE))]
  780 -> ccode$ccode[str_detect(ccode$cctry, fixed("Sri Lanka", ignore_case=TRUE))]
  780 -> ccode$ccode[str_detect(ccode$cctry, fixed("Sri Lanka (Ceylon)", ignore_case=TRUE))]
  781 -> ccode$ccode[str_detect(ccode$cctry, fixed("Maldives", ignore_case=TRUE))]
  790 -> ccode$ccode[str_detect(ccode$cctry, fixed("Nepal", ignore_case=TRUE))]
  800 -> ccode$ccode[str_detect(ccode$cctry, fixed("Thailand", ignore_case=TRUE))]
  811 -> ccode$ccode[str_detect(ccode$cctry, fixed("Cambodia", ignore_case=TRUE))]
  812 -> ccode$ccode[str_detect(ccode$cctry, fixed("Laos", ignore_case=TRUE))]
  812 -> ccode$ccode[str_detect(ccode$cctry, fixed("Lao People's Dem.Rep", ignore_case=TRUE))]
  812 -> ccode$ccode[str_detect(ccode$cctry, fixed("Lao People's Democratic Republic", ignore_case=TRUE))]
  816 -> ccode$ccode[str_detect(ccode$cctry, fixed("Vietnam")) & year >=1975]
  816 -> ccode$ccode[str_detect(ccode$cctry, fixed("Viet Nam", ignore_case=TRUE))]
  817 -> ccode$ccode[str_detect(ccode$cctry, fixed("Vietnam")) & year<=1975]
  817 -> ccode$ccode[str_detect(ccode$cctry, fixed("Republic of Vietnam", ignore_case=TRUE))]
  817 -> ccode$ccode[str_detect(ccode$cctry, fixed("Vietnam, Republic of", ignore_case=TRUE))]
  820 -> ccode$ccode[str_detect(ccode$cctry, fixed("Malaysia", ignore_case=TRUE))]
  830 -> ccode$ccode[str_detect(ccode$cctry, fixed("Singapore", ignore_case=TRUE))]
  830 -> ccode$ccode[str_detect(ccode$cctry, fixed("Singapor", ignore_case=TRUE))]
  835 -> ccode$ccode[str_detect(ccode$cctry, fixed("Brunei", ignore_case=TRUE))]
  840 -> ccode$ccode[str_detect(ccode$cctry, fixed("Philippines", ignore_case=TRUE))]
  850 -> ccode$ccode[str_detect(ccode$cctry, fixed("Indonesia", ignore_case=TRUE))]
  850 -> ccode$ccode[str_detect(ccode$cctry, fixed("Indonesi", ignore_case=TRUE))]
  860 -> ccode$ccode[str_detect(ccode$cctry, fixed("East Timor", ignore_case=TRUE))]
  860 -> ccode$ccode[str_detect(ccode$cctry, fixed("Timor-Leste", ignore_case=TRUE))]
  900 -> ccode$ccode[str_detect(ccode$cctry, fixed("Australia", ignore_case=TRUE))]
  900 -> ccode$ccode[str_detect(ccode$cctry, fixed("Australi", ignore_case=TRUE))]
  910 -> ccode$ccode[str_detect(ccode$cctry, fixed("Papua New Guinea", ignore_case=TRUE))]
  910 -> ccode$ccode[str_detect(ccode$cctry, fixed("PapuaNew", ignore_case=TRUE))]
  910 -> ccode$ccode[str_detect(ccode$cctry, fixed("PAPUA N.G.", ignore_case=TRUE))]
  920 -> ccode$ccode[str_detect(ccode$cctry, fixed("New Zealand", ignore_case=TRUE))]
  920 -> ccode$ccode[str_detect(ccode$cctry, fixed("NewZeala", ignore_case=TRUE))]
  935 -> ccode$ccode[str_detect(ccode$cctry, fixed("Vanuatu", ignore_case=TRUE))]
  940 -> ccode$ccode[str_detect(ccode$cctry, fixed("Solomon Islands", ignore_case=TRUE))]
  946 -> ccode$ccode[str_detect(ccode$cctry, fixed("Kiribati", ignore_case=TRUE))]
  947 -> ccode$ccode[str_detect(ccode$cctry, fixed("Tuvalu", ignore_case=TRUE))]
  950 -> ccode$ccode[str_detect(ccode$cctry, fixed("Fiji", ignore_case=TRUE))]
  955 -> ccode$ccode[str_detect(ccode$cctry, fixed("Tonga", ignore_case=TRUE))]
  970 -> ccode$ccode[str_detect(ccode$cctry, fixed("Nauru", ignore_case=TRUE))]
  983 -> ccode$ccode[str_detect(ccode$cctry, fixed("Marshall Islands", ignore_case=TRUE))]
  986 -> ccode$ccode[str_detect(ccode$cctry, fixed("Palau", ignore_case=TRUE))]
  987 -> ccode$ccode[str_detect(ccode$cctry, fixed("Federated States of Micronesia", ignore_case=TRUE))]
  987 -> ccode$ccode[str_detect(ccode$cctry, fixed("Micronesia (Federated States of)", ignore_case=TRUE))]
  987 -> ccode$ccode[str_detect(ccode$cctry, fixed("Micronesia, Fed. Sts.", ignore_case=TRUE))]
  987 -> ccode$ccode[str_detect(ccode$cctry, fixed("Micronesia", ignore_case=TRUE))]
  990 -> ccode$ccode[str_detect(ccode$cctry, fixed("Samoa", ignore_case=TRUE))]
  ccode<-cbind.data.frame(ccode$ccode, data, stringsAsFactors=FALSE)
  colnames(ccode)[1]<-"ccode"
  return(ccode)

}
